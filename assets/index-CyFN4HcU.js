var T=Object.defineProperty;var k=(o,e,t)=>e in o?T(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var s=(o,e,t)=>k(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();class A{constructor(e,t){s(this,"shapeType");s(this,"params");this.shapeType=e,this.params=t}}s(A,"type","AddShapeCommand");class x{constructor({from:e,to:t}){s(this,"from");s(this,"to");this.from=e,this.to=t}}s(x,"type","MoveCommand");class P{constructor({from:e,to:t}){s(this,"from");s(this,"to");this.from=e,this.to=t}}s(P,"type","ResizeCommand");class _{constructor(){s(this,"toolType","idle");s(this,"toolMode","idle")}setTool(e){this.toolType=e}setMode(e){this.toolMode=e}getTool(){return this.toolType}getMode(){return this.toolMode}clearTool(){this.toolType="select"}clearMode(){this.toolMode="idle"}}const m=new _;class b{constructor(e){s(this,"shapeId");this.shapeId=e,m.setTool("select")}}s(b,"type","SelectCommand");class ${constructor(){s(this,"handlers",new Map)}register(e,t){this.handlers.set(e,t)}execute(e){const t=e.constructor.type,n=this.handlers.get(t);if(n)try{n.execute(e)}catch(i){console.error(`Error while executing command ${e.constructor.name}:`,i)}else console.warn(`No handler registered for command: ${e.constructor.name}`)}}class O{constructor(e){s(this,"shapeManager");this.shapeManager=e}execute(e){const t=this.shapeManager.getAllShapes(),n=Math.max(0,...t.map(r=>r.zIndex??0)),i={...e.params,zIndex:n+1};this.shapeManager.addShape(e.shapeType,i)}}class U{constructor(e){s(this,"shapeManager");s(this,"shapeId");this.shapeManager=e,this.shapeId=this.shapeManager.getCurrentId(),console.log(this.shapeId)}execute(e){var r,a;const{to:t}=e;if(this.shapeManager.getType()==="NullShape")return;const i=this.shapeManager.getSetters();(r=i.position)==null||r.x(t.x),(a=i.position)==null||a.y(t.y)}}class F{constructor(e){s(this,"shapeManager");s(this,"shapeId");this.shapeManager=e,this.shapeId=this.shapeManager.getCurrentId(),console.log(this.shapeId)}execute(e){const{to:t}=e;if(this.shapeManager.getType()==="NullShape")return;const i=this.shapeManager.getSetters();i.position&&(typeof t.point.x=="number"&&i.position.x(t.point.x),typeof t.point.y=="number"&&i.position.y(t.point.y)),i.transform&&(typeof t.size.width=="number"&&i.transform.width(t.size.width),typeof t.size.height=="number"&&i.transform.height(t.size.height))}}class j{constructor(e){s(this,"shapeManager");this.shapeManager=e}execute(e){this.shapeManager.select(e.shapeId)}}class D{constructor(){s(this,"listeners",{})}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(n=>n!==t))}emit(e,t){for(const n of this.listeners[e])try{n(t)}catch(i){console.error(`Error in listener for event "${String(e)}":`,i)}}}class M{constructor(e="div"){s(this,"element");this.element=document.createElement(e)}render(e){this.element&&e.append(this.element)}destroy(){this.element.remove()}}class W{constructor({labelText:e,type:t="number",value:n,onChange:i}){s(this,"span");s(this,"input");s(this,"component");s(this,"onChange");this.component=new M("label"),this.span=document.createElement("span"),this.input=document.createElement("input"),this.onChange=i,this.span.textContent=e,this.component.element.setAttribute("for",e),this.input.setAttribute("id",e),this.input.setAttribute("type",t),this.input.setAttribute("value",n),this.component.element.classList.add("inspector__label"),this.span.classList.add("inspector__label__span"),this.input.classList.add("inspector__input"),this.component.element.append(this.span),this.component.element.append(this.input),this.input.addEventListener("blur",r=>{let h=r.target.value;t==="number"&&(h=Math.round(Number(h)),isNaN(h))||this.onChange(h.toString())})}getComponent(){return this.component}updateValue(e){const t=this.input;t.value!==e&&(t.value=e)}}class V{constructor(e="row"){s(this,"component");this.component=new M,this.component.element.classList.add("inspector__wrapper",`inspector__wrapper--${e}`)}getComponent(){return this.component}}class I{constructor(e="header"){s(this,"span");s(this,"component");this.component=new M,this.span=document.createElement("span"),this.span.textContent=e,this.component.element.classList.add("inspector__section","p-inner"),this.span.classList.add("inspector__header"),this.component.element.append(this.span)}getComponent(){return this.component}}function X(o,e,t){e.x===t.x&&e.y===t.y||o.execute(new x({from:e,to:t}))}class q{constructor({shapeManager:e,eventBus:t,commandBus:n,container:i}){s(this,"shapeManager");s(this,"eventBus");s(this,"commandBus");s(this,"container");s(this,"fields",new Map);this.shapeManager=e,this.eventBus=t,this.commandBus=n,this.container=i,this.eventBus.on("shape:selected",()=>{this.render()}),this.eventBus.on("shape:updated",({id:r})=>{r===this.shapeManager.getCurrentId()&&this.updateInputs()}),this.render()}render(){const e=this.shapeManager.getProperties(),t=this.shapeManager.getSetters();this.container.innerHTML="";const n=new I(e.general.name);e.general.type!=="NullShape"&&(Object.entries(e).forEach(([i,r])=>{if(i!=="general"){const a=new I(i),h=new V("column");Object.entries(r).forEach(([d,p])=>{const u=d,l=t[i][u];if(typeof l=="function"){const c=typeof p=="number",S=new W({labelText:d[0].toUpperCase(),value:String(p),type:"text",onChange:C=>{const L=this.shapeManager.getCurrentId(),H=this.shapeManager.getProperties().position;l(c?Number(C):C);const R=this.shapeManager.getProperties().position;i==="position"&&(d==="x"||d==="y")&&X(this.commandBus,H,R),this.eventBus.emit("shape:updated",{id:L})}}),N=`${i}.${d}`;this.fields.set(N,S),S.getComponent().render(h.getComponent().element)}}),h.getComponent().render(a.getComponent().element),a.getComponent().render(n.getComponent().element)}}),n.getComponent().render(this.container))}updateInputs(){const e=this.shapeManager.getProperties();for(const[t,n]of Object.entries(e))for(const[i,r]of Object.entries(n)){const a=`${t}.${i}`,h=this.fields.get(a);h&&h.updateValue(String(r))}}}class Y{constructor({name:e,id:t,onSelect:n}){s(this,"id");s(this,"component");s(this,"button");s(this,"onSelect");this.component=new M("li"),this.id=t,this.onSelect=n,this.component.element.classList.add("list-objects__item"),this.component.element.setAttribute("data-id",t),this.button=document.createElement("button"),this.button.classList.add("btn-reset"),this.button.textContent=e,this.component.element.append(this.button),this.addEventListeners()}addEventListeners(){this.component.element.addEventListener("click",()=>this.onSelect(this.id))}setSelected(e){this.component.element.classList.toggle("select-item",e)}getComponent(){return this.component}}class Z{constructor({onSelect:e}){s(this,"children",new Map);s(this,"onSelect");s(this,"component");this.component=new M("ul"),this.onSelect=e,this.component.element.classList.add("list-reset","list-objects")}addItem({name:e,id:t}){const n=new Y({name:e,id:t,onSelect:this.onSelect});this.children.set(t,n),n.getComponent().render(this.component.element)}removeItem(e){var t;(t=this.children.get(e))==null||t.getComponent().destroy(),this.children.delete(e)}selectItem(e){this.children.forEach(t=>{t.setSelected(t.id===e)})}getComponent(){return this.component}}class G{constructor(e,t,n){s(this,"container");s(this,"mainList");s(this,"commandBus");s(this,"eventBus");this.container=e,this.commandBus=t,this.eventBus=n,this.mainList=new Z({onSelect:i=>{this.commandBus.execute(new b(i))}}),this.eventBus.on("shape:selected",({id:i})=>{this.mainList.selectItem(i)}),this.eventBus.on("shape:created",({id:i,name:r})=>{this.addItem({id:i,name:r})}),this.mainList.getComponent().render(this.container)}addItem({name:e,id:t}){this.mainList.addItem({name:e,id:t})}removeItem(e){this.mainList.removeItem(e)}}class J{constructor(){s(this,"name","NullShape");s(this,"id","0");s(this,"type","NullShape");s(this,"zIndex",-1)}}class Q{constructor({x:e=100,y:t=100,width:n=100,height:i=100,fill:r="#000000",cornerRadius:a=0,zIndex:h=1,name:d="Untitled"}={}){s(this,"x");s(this,"y");s(this,"width");s(this,"height");s(this,"fill");s(this,"cornerRadius");s(this,"name");s(this,"zIndex");s(this,"id");s(this,"type","Rectangle");this.x=e,this.y=t,this.width=n,this.height=i,this.fill=r,this.cornerRadius=a,this.id=crypto.randomUUID(),this.name=d,this.zIndex=h}}class K{getProperties(){return{general:{id:"0",name:"NullShape",type:"NullShape",zIndex:-1},position:{x:0,y:0}}}getSetters(){return{}}}class ee{constructor(e){s(this,"shape");this.shape=e}getProperties(){return{general:{name:this.shape.name,id:this.shape.id,type:this.shape.type,zIndex:this.shape.zIndex},position:{x:this.shape.x,y:this.shape.y},transform:{width:this.shape.width,height:this.shape.height,cornerRadius:this.shape.cornerRadius},fill:{fill:this.shape.fill}}}getSetters(){return{general:{name:e=>this.shape.name=e},position:{x:e=>{this.shape.x=Math.round(e)},y:e=>this.shape.y=Math.round(e)},transform:{width:e=>this.shape.width=Math.round(e),height:e=>this.shape.height=Math.round(e),cornerRadius:e=>this.shape.cornerRadius=Math.round(e)},fill:{fill:e=>{if(e[0]!=="#")throw new Error("Цвет должен быть задан в формате #HEX");this.shape.fill=e}}}}}const w={Rectangle:{shape:Q,strategyFactory:o=>new ee(o),props:{},setters:{}},NullShape:{shape:J,strategyFactory:()=>new K,props:{},setters:{}}};function z(o){const e=w[o.type];if(!e)throw new Error(`No strategy found for type: ${o.type}`);return e.strategyFactory(o)}class te{constructor(e){s(this,"nameCounters",new Map);s(this,"eventBus");s(this,"selectedShape");s(this,"strategy");s(this,"shapes",new Map);s(this,"nullShape",new w.NullShape.shape);this.eventBus=e,this.selectedShape=this.nullShape,this.strategy=w.NullShape.strategyFactory(),this.eventBus.on("shapeManager:selected",({id:t})=>{this.select(t)})}addShape(e,t){const n=w[e];if(!n)throw new Error(`Unknown shape type: ${e}`);const i=this.generateName(e),r=new n.shape({...t,name:i,type:e});this.shapes.set(r.id,r),this.selectedShape=r,this.strategy=z(r),this.eventBus.emit("shape:created",{id:this.selectedShape.id,name:this.selectedShape.name}),this.eventBus.emit("shape:selected",{id:this.selectedShape.id})}removeShape(e){this.shapes.delete(e)}select(e){const t=this.shapes.get(e);if(!t)return this.unselect();this.selectedShape=t,this.strategy=z(this.selectedShape),this.eventBus.emit("shape:selected",{id:this.selectedShape.id})}unselect(){this.selectedShape=this.nullShape,this.strategy=w.NullShape.strategyFactory(),this.eventBus.emit("shape:selected",{id:this.selectedShape.id})}getProperties(){return this.strategy.getProperties()}getSetters(){return this.strategy.getSetters()}getAllShapes(){return Array.from(this.shapes.values())}getType(){return this.selectedShape.type}getCurrentId(){return this.selectedShape.id}generateName(e){const n=(this.nameCounters.get(e)||0)+1;return this.nameCounters.set(e,n),`${e} ${n}`}}function E(o){const e=document.querySelector("svg"),t=e.createSVGPoint();t.x=o.clientX,t.y=o.clientY;const n=t.matrixTransform(e.getScreenCTM().inverse());return{x:n.x,y:n.y}}class se{constructor(e){s(this,"commandBus");this.commandBus=e}handleAddRectangle(e){const t=Math.round(e.x-50),n=Math.round(e.y-50);this.commandBus.execute(new A("Rectangle",{width:100,height:100,x:t,y:n}))}}class ne{constructor({shapeManager:e,commandBus:t,eventBus:n}){s(this,"initialPos",{x:0,y:0});s(this,"currentPos",{x:0,y:0});s(this,"offset",{x:0,y:0});s(this,"shapeManager");s(this,"commandBus");s(this,"eventBus");this.shapeManager=e,this.commandBus=t,this.eventBus=n}prepareMove(e){const t=this.shapeManager.getProperties().position;this.offset={x:e.x-t.x,y:e.y-t.y},this.initialPos={...t},this.currentPos={...t}}handleMovePointer(e){var i,r;const t={x:Math.round(e.x-this.offset.x),y:Math.round(e.y-this.offset.y)};if(t.x===this.currentPos.x&&t.y===this.currentPos.y)return;const n=this.shapeManager.getSetters();(i=n.position)==null||i.x(t.x),(r=n.position)==null||r.y(t.y),this.currentPos=t,this.eventBus.emit("shape:updated",{id:this.shapeManager.getCurrentId()})}finalizeMove(){this.initialPos.x===this.currentPos.x&&this.initialPos.y==this.currentPos.y||(this.commandBus.execute(new x({from:this.initialPos,to:this.currentPos})),this.initialPos=this.currentPos=this.offset={x:0,y:0})}}class ie{constructor({shapeManager:e,commandBus:t,eventBus:n}){s(this,"initialSize",{width:0,height:0});s(this,"initialPos",{x:0,y:0});s(this,"initialMousePos",{x:0,y:0});s(this,"direction","");s(this,"shapeManager");s(this,"commandBus");s(this,"eventBus");this.shapeManager=e,this.commandBus=t,this.eventBus=n}prepareResize(e,t){const n=this.shapeManager.getProperties().transform;n&&(this.initialSize={width:n.width,height:n.height},this.initialPos={...this.shapeManager.getProperties().position},this.initialMousePos={...e},this.direction=t)}handleMovePointer(e,t){var g,l,c,S;const n=this.shapeManager.getSetters(),i=e.x-this.initialMousePos.x,r=e.y-this.initialMousePos.y,a=10;let h=this.initialPos.x,d=this.initialPos.y,p=this.initialSize.width,u=this.initialSize.height;switch(this.direction){case"top":d+=r,u-=r;break;case"right":p+=i;break;case"bottom":u+=r;break;case"left":h+=i,p-=i;break;case"top-left":h+=i,d+=r,p-=i,u-=r;break;case"top-right":d+=r,p+=i,u-=r;break;case"bottom-left":h+=i,p-=i,u+=r;break;case"bottom-right":p+=i,u+=r;break}p<a&&(["left","top-left","bottom-left"].includes(this.direction)&&(h-=a-p),p=a),u<a&&(["top","top-left","top-right"].includes(this.direction)&&(d-=a-u),u=a),(g=n.position)==null||g.x(h),(l=n.position)==null||l.y(d),(c=n.transform)==null||c.width(p),(S=n.transform)==null||S.height(u),this.eventBus.emit("shape:updated",{id:t})}finalizeMove(){const e=this.shapeManager.getProperties().transform;if(!e)return;const{x:t,y:n}=this.shapeManager.getProperties().position,{width:i,height:r}=e;(i!==this.initialSize.width||r!==this.initialSize.height||t!==this.initialPos.x||n!==this.initialPos.y)&&this.commandBus.execute(new P({from:{point:this.initialPos,size:this.initialSize},to:{point:{x:t,y:n},size:{width:i,height:r}}}))}}class re{constructor(e,t,n){s(this,"currentShapeId","");s(this,"mousePos",{x:0,y:0});s(this,"commandBus");s(this,"eventBus");s(this,"shapeManager");s(this,"moveHandler");s(this,"addHandler");s(this,"resizeHandler");this.commandBus=e,this.eventBus=t,this.shapeManager=n,this.moveHandler=new ne({shapeManager:this.shapeManager,commandBus:this.commandBus,eventBus:this.eventBus}),this.resizeHandler=new ie({shapeManager:this.shapeManager,commandBus:this.commandBus,eventBus:this.eventBus}),this.addHandler=new se(e),this.initEventListeners()}initEventListeners(){this.eventBus.on("shape:created",this.onShapeSelected.bind(this)),this.eventBus.on("shape:selected",this.onShapeSelected.bind(this))}onPointerDown(e){var a,h;const t=m.getTool(),n=e.target,i=(a=n==null?void 0:n.dataset)==null?void 0:a.id,r=(h=n==null?void 0:n.dataset)==null?void 0:h.role;if(this.mousePos=E(e),t==="rectangle"&&this.addHandler.handleAddRectangle(this.mousePos),t==="idle"&&i&&(this.commandBus.execute(new b(i)),m.setTool("select")),t==="select")if((!i||i!==this.currentShapeId)&&(i?this.commandBus.execute(new b(i)):this.resetSelection()),r==="resize-handle"){const d=n.dataset.resize;d&&(m.setMode("resize"),this.resizeHandler.prepareResize(this.mousePos,d))}else m.setMode("move"),this.moveHandler.prepareMove(this.mousePos)}onPointerMove(e){this.mousePos=E(e),m.getMode()==="move"&&this.moveHandler.handleMovePointer(this.mousePos),m.getMode()==="resize"&&this.resizeHandler.handleMovePointer(this.mousePos,this.currentShapeId)}onPointerUp(e){m.getMode()==="move"&&this.moveHandler.finalizeMove(),m.getMode()==="resize"&&this.resizeHandler.finalizeMove(),m.setMode("idle")}onShapeSelected({id:e}){this.currentShapeId=e,m.setTool("select")}resetSelection(){m.setTool("idle"),m.setMode("idle"),this.currentShapeId=""}getSceneHandlers(){return new Map([["pointerdown",this.onPointerDown.bind(this)],["pointermove",this.onPointerMove.bind(this)],["pointerup",this.onPointerUp.bind(this)]])}}class oe{constructor(e){s(this,"element");s(this,"props");this.props=e,this.element=this.createElement()}createElement(){const e=document.createElementNS("http://www.w3.org/2000/svg","rect");return this.updateAttributes(e),e.dataset.id=this.props.general.id,e}updateAttributes(e){const{x:t,y:n}=this.props.position,{width:i,height:r,cornerRadius:a}=this.props.transform,{fill:h}=this.props.fill,{id:d}=this.props.general;e.setAttribute("x",t.toString()),e.setAttribute("y",n.toString()),e.setAttribute("width",i.toString()),e.setAttribute("height",r.toString()),e.setAttribute("fill",h),e.setAttribute("rx",a.toString()),e.setAttribute("data-id",d)}update(e){this.props=e,this.updateAttributes(this.element)}}class ae{static create(e){switch(e.general.type){case"Rectangle":return new oe(e);default:throw new Error(`Unknown shape type: ${e.general.type}`)}}}class he{constructor(){s(this,"strokeWidth",2);s(this,"strokeColor","#ff0000")}hitBoxRectangle(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.setAttribute("data-role","hitbox"),t.setAttribute("data-id",e.general.id);const{x:n,y:i}=e.position,{width:r,height:a}=e.transform,h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",(n-4).toString()),h.setAttribute("y",(i-4).toString()),h.setAttribute("width",(r+8).toString()),h.setAttribute("height",(a+8).toString()),h.setAttribute("fill","transparent"),h.setAttribute("stroke",this.strokeColor),h.setAttribute("stroke-dasharray","4"),h.setAttribute("data-role","border"),h.setAttribute("data-id",e.general.id),t.appendChild(h);const d=[{x:n,y:i-4,width:r,height:8,dir:"top"},{x:n+r,y:i,width:8,height:a,dir:"right"},{x:n,y:i+a,width:r,height:8,dir:"bottom"},{x:n-4,y:i,width:8,height:a,dir:"left"}];for(const l of d){const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x",l.x.toString()),c.setAttribute("y",l.y.toString()),c.setAttribute("width",l.width.toString()),c.setAttribute("height",l.height.toString()),c.setAttribute("fill","transparent"),c.setAttribute("cursor",this.getCursorByDirection(l.dir)),c.setAttribute("data-role","resize-handle"),c.setAttribute("data-resize",l.dir),c.setAttribute("data-id",e.general.id),t.appendChild(c)}const p=10,u=[{x:n-p/2,y:i-p/2,dir:"top-left"},{x:n+r-p/2,y:i-p/2,dir:"top-right"},{x:n-p/2,y:i+a-p/2,dir:"bottom-left"},{x:n+r-p/2,y:i+a-p/2,dir:"bottom-right"}];for(const l of u){const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x",l.x.toString()),c.setAttribute("y",l.y.toString()),c.setAttribute("width",p.toString()),c.setAttribute("height",p.toString()),c.setAttribute("fill","#ffffff"),c.setAttribute("stroke",this.strokeColor),c.setAttribute("stroke-width","1"),c.setAttribute("cursor",this.getCursorByDirection(l.dir)),c.setAttribute("data-role","resize-handle"),c.setAttribute("data-resize",l.dir),c.setAttribute("data-id",e.general.id),t.appendChild(c)}const g=document.createElementNS("http://www.w3.org/2000/svg","rect");return g.setAttribute("x",n.toString()),g.setAttribute("y",i.toString()),g.setAttribute("width",r.toString()),g.setAttribute("height",a.toString()),g.setAttribute("fill","transparent"),g.setAttribute("stroke",this.strokeColor),g.setAttribute("stroke-width",this.strokeWidth.toString()),g.setAttribute("data-role","body"),g.setAttribute("data-id",e.general.id),t.appendChild(g),t}getCursorByDirection(e){switch(e){case"top":case"bottom":return"ns-resize";case"left":case"right":return"ew-resize";case"top-left":case"bottom-right":return"nwse-resize";case"top-right":case"bottom-left":return"nesw-resize";default:return"default"}}}class ce{constructor({eventBus:e,shapeManager:t,viewport:n}){s(this,"currentSelection",null);s(this,"ui",new he);s(this,"eventBus");s(this,"shapeManager");s(this,"viewport");this.eventBus=e,this.shapeManager=t,this.viewport=n,this.eventBus.on("shape:selected",()=>{this.selectShape()}),this.eventBus.on("shape:updated",()=>{this.selectShape()})}selectShape(){switch(this.clear(),this.shapeManager.getType()){case"Rectangle":const t=this.shapeManager.getProperties(),n=this.ui.hitBoxRectangle(t);this.viewport.append(n),this.currentSelection=n;break}}clear(){var e;(e=this.currentSelection)!=null&&e.parentNode&&this.currentSelection.parentNode.removeChild(this.currentSelection),this.currentSelection=null}}class pe{constructor({container:e,handlers:t,eventBus:n,shapeManager:i}){s(this,"container");s(this,"scene");s(this,"viewport");s(this,"handlers");s(this,"eventBus");s(this,"shapeManager");s(this,"shapes",new Map);s(this,"hitBox");this.shapeManager=i,this.eventBus=n,this.handlers=t,this.container=e,this.scene=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.viewport=document.createElementNS("http://www.w3.org/2000/svg","g"),this.hitBox=new ce({eventBus:n,shapeManager:i,viewport:this.viewport}),this.hitBox,this.scene.setAttribute("width","100%"),this.scene.setAttribute("height","100%"),this.scene.style.userSelect="none",this.scene.append(this.viewport),this.container.appendChild(this.scene),this.eventBus.on("shape:created",()=>{const r=this.shapeManager.getProperties(),a=ae.create(r);this.shapes.set(r.general.id,a),this.viewport.append(a.element)}),this.handlers.getSceneHandlers().forEach((r,a)=>{this.scene.addEventListener(a,h=>r(h))}),this.eventBus.on("shape:updated",({id:r})=>{const a=this.shapes.get(r);a==null||a.update(this.shapeManager.getProperties())})}}const de=document.getElementById("layers"),le=document.getElementById("inspector"),B=document.getElementById("rectButton"),ue=document.getElementById("scene"),v=new D,f=new $,y=new te(v),ge=new re(f,v,y);new G(de,f,v);new q({shapeManager:y,eventBus:v,commandBus:f,container:le});new pe({container:ue,handlers:ge,eventBus:v,shapeManager:y,commandBus:f});f.register(b.type,new j(y));f.register(A.type,new O(y));f.register(x.type,new U(y));f.register(P.type,new F(y));B==null||B.addEventListener("click",()=>{m.setTool("rectangle")});
